class inherited СИС2.БазовыйБланк "Дата Закрытия Периода";

inclass

inobject

--------------------------------------------------------------------------------
--{ Обработчики событий бланка
    var ДатаЗакрытия:Дата;
    var ДатаЗакрытияОлд:Дата;

  проц шаблон_ПриОткрытии(Создается :Логическое);
     
    унаследованный шаблон_ПриОткрытии(Создается);
      if Функции.ЗаписьПоКоду(МашинаРеквизитов.Настройки.Реквизит,"ЗакрытыйПериод.ДатаЗакрытия").Комментарий<>"" then
          try
           ДатаЗакрытия       =StringToDate(Функции.ЗаписьПоКоду(МашинаРеквизитов.Настройки.Реквизит,"ЗакрытыйПериод.ДатаЗакрытия").Комментарий);
          исключение
          конец;
      end;
      ДатаЗакрытияОлд= ДатаЗакрытия;
  конец;

  проц шаблон_ПриЗакрытии(Уничтожается :Логическое);
     
    унаследованный шаблон_ПриЗакрытии(Уничтожается);
    if не ДатаЗакрытияОлд= ДатаЗакрытия then
         if ( ВопрДаОтказ ("Установить новое закрытие периода ?") = кмдВерно ) then
             Функции.ЗаписьПоКоду(МашинаРеквизитов.Настройки.Реквизит,"ЗакрытыйПериод.ДатаЗакрытия").Комментарий=стр(ДатаЗакрытия);
         fi;
      
    end;
  конец;

--}

end